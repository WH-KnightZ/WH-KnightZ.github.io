{"version":3,"sources":["views/user/mobility/MobilitySearch.module.scss","views/user/mobility/MobilitySearch.tsx"],"names":["module","exports","MobilitySearch","callApi","useApi","history","useHistory","useState","searchName","setSearchName","searchSuggestionNames","setSearchSuggestionNames","searchRef","useRef","showModal","setShowModal","removeKeyword","keywordId","filter","item","id","loading","method","api","config","rest","removeSearchHistoryKeyword","removeAllSearchHistoryKeywords","response","startSearch","push","keyword","searchParams","innerRef","clearBtn","handleEnter","useEffect","current","focus","getHistoriesKeywords","data","status","SUCCESS","map","toLowerCase","showClear","length","show","handleClose","title","content","up","down","upCallback","downCallback","className","onClick","styles","searchArea","placeholder","style","visibility","listSuggestItems","lower","arr","includes","slice","index","fullKeywords","split","forEach","item1","whiteSpace","Math","random","color","splice","suggestItemWrapper","border","suggestItemContent","circle","size","icon","e","iconStyle","fontWeight","showSuggestionName"],"mappings":"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","file":"static/js/50.5e129f82.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchArea\":\"MobilitySearch_searchArea__2-eLj\",\"listSuggestItems\":\"MobilitySearch_listSuggestItems__3l84N\",\"suggestItemWrapper\":\"MobilitySearch_suggestItemWrapper__2Mf14\",\"suggestItemContent\":\"MobilitySearch_suggestItemContent__1SQkA\"};","import React, { useEffect, useRef, useState } from 'react';\nimport config from '../../../config';\nimport { SUCCESS } from '../../../store/callApi/actions';\nimport { RouteComponentProps, useHistory } from 'react-router-dom';\nimport { HBButtonIcon, HBButtonSmall, HBModalConfirm, HBSearch } from '../../../hbBaseClass';\nimport styles from './MobilitySearch.module.scss';\nimport { useApi } from 'store/callApi';\n\nconst MobilitySearch: React.FC<RouteComponentProps> = () => {\n  const { callApi } = useApi();\n\n  const history = useHistory();\n  const [searchName, setSearchName] = useState('');\n  const [searchSuggestionNames, setSearchSuggestionNames] = useState<any[]>([]);\n  const searchRef = useRef<any>(null);\n\n  const [showModal, setShowModal] = useState(false);\n\n  const removeKeyword = (keywordId?: any) => {\n    if (keywordId) {\n      setSearchSuggestionNames(searchSuggestionNames.filter((item: any) => item.id !== keywordId));\n    } else {\n      setSearchSuggestionNames([]);\n    }\n    callApi(\n      {\n        loading: false,\n        method: 'delete',\n        api: keywordId\n          ? config.rest.removeSearchHistoryKeyword(keywordId)\n          : config.rest.removeAllSearchHistoryKeywords(),\n      },\n      (response) => {},\n    );\n  };\n\n  const startSearch = (item: { id: string; keyword: string }) => {\n    history.push(`/mobility?search=${item.keyword}`);\n  };\n\n  const showSuggestionName = () => {\n    const lower = searchName.toLowerCase();\n    const arr = searchSuggestionNames.filter((item) => item.keyword.includes(lower)).slice(0, 10);\n    if (arr.length === 0) return <div className=\"search-group-item disabled\">-</div>;\n    return arr.map((item: { id: string; keyword: string }, index: number) => {\n      let splitKeywords;\n      let fullKeywords: any = [];\n      if (lower) {\n        splitKeywords = item.keyword.split(lower);\n        splitKeywords.forEach((item1) => {\n          fullKeywords.push(\n            <span key={Math.random()} style={{ whiteSpace: 'pre' }}>\n              {item1}\n            </span>,\n          );\n          fullKeywords.push(\n            <span key={Math.random()} style={{ whiteSpace: 'pre', color: 'var(--violet-80)' }}>\n              {lower}\n            </span>,\n          );\n        });\n        fullKeywords.splice(fullKeywords.length - 1, 1);\n      }\n      return (\n        <div\n          className={`search-group-item d-flex align-items-center justify-content-between ${styles.suggestItemWrapper}`}\n          style={index === arr.length - 1 ? { border: 'none' } : {}}\n          key={item.id}\n        >\n          <div className={`d-flex align-items-center ${styles.suggestItemContent}`} onClick={() => startSearch(item)}>\n            <i className=\"hb-icon-zoom-in hb-select-category-icon-search\" />\n            {fullKeywords.length > 0 ? fullKeywords : item.keyword}\n          </div>\n          <HBButtonIcon\n            circle={{ color: '#d3d4d5', size: 24 }}\n            icon=\"cross\"\n            size={18}\n            color=\"var(--violet-100)\"\n            onClick={(e: any) => removeKeyword(item.id)}\n            iconStyle={{ fontWeight: 'bold' }}\n          />\n        </div>\n      );\n    });\n  };\n\n  const searchParams = {\n    innerRef: searchRef,\n    clearBtn: true,\n    searchName,\n    setSearchName,\n    handleEnter: (keyword: string) => startSearch({ id: '', keyword }),\n  };\n\n  useEffect(() => {\n    searchRef.current.focus();\n    callApi(\n      {\n        method: 'get',\n        api: config.rest.getHistoriesKeywords(''),\n      },\n      (response) => {\n        const { data, status } = response;\n        if (status === SUCCESS) {\n          setSearchSuggestionNames(\n            data.map((item: any) => {\n              return { ...item, keyword: item.keyword.toLowerCase() };\n            }),\n          );\n        }\n      },\n    );\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const showClear = searchSuggestionNames.length > 0 && !searchName;\n\n  return (\n    <div>\n      <HBModalConfirm\n        show={showModal}\n        handleClose={() => setShowModal(false)}\n        title=\"Suchverlauf löschen\"\n        content=\"Sind Sie sicher, dass Sie Ihren Suchverlauf vollständig löschen möchten?\"\n        up=\"Ja, löschen\"\n        down=\"Abbrechen\"\n        upCallback={() => {\n          setShowModal(false);\n          removeKeyword();\n        }}\n        downCallback={() => setShowModal(false)}\n      />\n      <div className=\"hb-mx-20\">\n        <div className=\"d-flex justify-content-end hb-my-28\">\n          <HBButtonSmall onClick={() => history.push('/mobility')}>\n            <i className=\"hb-icon-cross hb-icon-lg\" /> Schließen\n          </HBButtonSmall>\n        </div>\n      </div>\n      <div className=\"hb-card\">\n        <div\n          className={`hb-margin-30 ${styles.searchArea}`}\n          // style={{ paddingBottom: searchSuggestionNames.length > 0 ? 0 : 20 }}\n        >\n          <HBSearch {...searchParams} placeholder=\"Suchbegriff\" />\n          <div>\n            <div className=\"hb-select-category-title d-flex justify-content-between\">\n              {showClear ? 'Zuletzt gesucht' : 'Suchergebnisse'}\n              <HBButtonSmall\n                style={{ visibility: !showClear ? 'hidden' : 'visible' }}\n                onClick={() => setShowModal(true)}\n              >\n                Verlauf löschen\n              </HBButtonSmall>\n            </div>\n            <div className=\"hb-select-category-search-suggestion\">\n              <div className={`violet hb-scroll ${styles.listSuggestItems}`}>{showSuggestionName()}</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default MobilitySearch;\n"],"sourceRoot":""}