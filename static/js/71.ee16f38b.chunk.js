(this["webpackJsonphb-frontend"]=this["webpackJsonphb-frontend"]||[]).push([[71],{1015:function(e,t,a){"use strict";a.r(t);var i=a(3),n=a(47),c=a(7),l=a(16),s=a(1),d=a(39),o=a(56),r=a(19),j=a(98),u=a(29),b=a(38),O=a(32),g=a(31),h=a(189);t.default=function(e){var t,a=Object(h.b)().callApi,m=(null===(t=e.match)||void 0===t?void 0:t.params).id,f=Object(s.useState)({data:[],total:0,totalPages:0,loading:!0,page:1}),p=Object(l.a)(f,2),v=p[0],y=p[1],x=Object(s.useState)(null),w=Object(l.a)(x,2),N=w[0],k=w[1],S=Object(s.useState)(""),C=Object(l.a)(S,2),_=C[0],E=C[1],V=Object(s.useState)(""),z=Object(l.a)(V,2),D=z[0],P=z[1],T=Object(s.useState)({data:[],loading:!0,full:!1,page:1}),A=Object(l.a)(T,2),B=A[0],L=A[1],M=Object(s.useState)(null),R=Object(l.a)(M,2),I=R[0],J=R[1],q=Object(s.useState)({show:!1,id:"",name:""}),Y=Object(l.a)(q,2),F=Y[0],G=Y[1],H=[{key:"no",_style:{width:"4%"}},{key:"name",label:"Title",_style:{width:160}},{key:"description",_style:{width:"24%"}},{key:"created_date",_style:{width:"8%"},isDate:!0},{key:"modified_date",label:"Last modified",_style:{width:"8%"},isDate:!0},{key:"uploader",_style:{width:"10%"}},{key:"tag",_style:{width:"5%"},renderContent:function(e){if(!e.tag)return Object(i.jsx)("div",{className:"align-middle",children:"-"});var t=e.tag.split(","),a=t.length>2;return a&&(t[1]+=" ..."),Object(i.jsx)("div",{title:a?e.tag:"",className:"align-middle",children:t.slice(0,2).map((function(e){return Object(i.jsx)("div",{children:e})}))})}},{key:"views",_style:{width:"5%"}},{key:"comment",_style:{width:"5%"}},{key:"like",_style:{width:"5%"}},{key:"status",_style:{width:"8%"}},{key:"action",_style:{width:"10%"},renderContent:function(e){return Object(i.jsx)(r.d,{color:"primary",variant:"outline",shape:"square",size:"sm",style:{marginRight:10},onClick:function(){return G({show:!0,id:e.id,name:e.name})},children:Object(i.jsx)("i",{className:"fas fa-trash-alt",children:" "})})}}];Object(s.useEffect)((function(){a({method:"get",api:"/api/v1/admin/categories/".concat(m)},(function(e){var t=e.status,a=e.data;t===b.c?(W(Object(c.a)({loading:!1},a)),ee(Object(c.a)(Object(c.a)({},$),{},{editing:!1,value:a.title})),ne(Object(c.a)(Object(c.a)({},ie),{},{editing:!1,value:a.description}))):W(Object(c.a)(Object(c.a)({},U),{},{loading:!1}))})),se("",1)}),[]),Object(s.useEffect)((function(){le(_,1)}),[N,I]);var K=Object(s.useState)({loading:!0,title:"",description:""}),Q=Object(l.a)(K,2),U=Q[0],W=Q[1],X=Object(s.useState)({editing:!1,loading:!1,value:""}),Z=Object(l.a)(X,2),$=Z[0],ee=Z[1],te=Object(s.useState)({editing:!1,loading:!1,value:""}),ae=Object(l.a)(te,2),ie=ae[0],ne=ae[1];Object(s.useEffect)((function(){$.editing&&oe.current.focus()}),[$.editing]),Object(s.useEffect)((function(){ie.editing&&re.current.focus()}),[ie.editing]),Object(s.useEffect)((function(){if($.editing||ie.editing)return window.onbeforeunload=function(){return!0},function(){window.onbeforeunload=null}}),[$.editing,ie.editing]);var ce=Object(i.jsx)("div",{});v.loading||v.total||(ce=Object(i.jsx)("div",{children:"No videos"}));var le=function(e,t){y((function(e){return Object(c.a)(Object(c.a)({},e),{},{loading:!0})})),a({method:"get",api:u.d.rest.getVideos(m,I?I.id:"",N?N.id:"",10,t,e,"")},(function(e){var a=e.status,i=e.data;a===b.c?y({data:i.video.map((function(e,a){return Object(O.b)(e,a,t)})),loading:!1,total:i.total,totalPages:Math.ceil(i.total/10),page:t}):y((function(e){return Object(c.a)(Object(c.a)({},e),{},{loading:!1})}))}))},se=function(e,t){a({method:"get",api:"/api/v1/admin/video/user?page_size=10&page_number=".concat(t,"&search_name=").concat(e)},(function(a){var i=a.status,c=a.data;i===b.c&&L((function(a){var i=c.users.map((function(e){return{id:e.id,name:e.first_name+" "+e.last_name}}));return{data:1===t?""===e?[null].concat(Object(n.a)(i)):i:[].concat(Object(n.a)(a.data),Object(n.a)(i)),loading:!1,full:c.users.length<10,page:t}}))}))},de=function(e){e?ee(Object(c.a)(Object(c.a)({},$),{},{loading:!0})):ne(Object(c.a)(Object(c.a)({},ie),{},{loading:!0})),a({method:"put",api:"/api/v1/admin/categories/".concat(m),body:{title:e?$.value:U.title,description:e?U.description:ie.value}},(function(t){t.status===b.c?e?(ee(Object(c.a)(Object(c.a)({},$),{},{editing:!1,loading:!1})),W((function(e){return Object(c.a)(Object(c.a)({},e),{},{title:$.value})}))):(ne(Object(c.a)(Object(c.a)({},ie),{},{editing:!1,loading:!1})),W((function(e){return Object(c.a)(Object(c.a)({},e),{},{description:ie.value})}))):e?ee(Object(c.a)(Object(c.a)({},$),{},{loading:!1})):ne(Object(c.a)(Object(c.a)({},ie),{},{loading:!1}))}))},oe=Object(s.useRef)(null),re=Object(s.useRef)(null);return Object(i.jsxs)("div",{className:"px-5 mx-3",style:{marginTop:10},children:[($.editing||ie.editing)&&Object(i.jsx)(d.a,{when:!0,message:"Changes you made may not be saved."}),Object(i.jsx)(o.a,{className:"py-2 size-1",to:"/admin/mobility/categories",children:"Category Management"}),Object(i.jsx)("span",{className:"size-0 pl-2",children:"> Edit Category"}),Object(i.jsxs)("div",{className:"row py-5",children:[Object(i.jsx)(j.e,{isVisible:F.show,title:"Delete Video",renderContent:Object(g.a)("Are you sure to delete the video",F.name),leftButtonText:"No",rightButtonText:"Yes",leftButtonOnPress:function(){return G({show:!1,id:"",name:""})},rightButtonOnPress:function(){a({method:"delete",api:"/api/v1/admin/video/".concat(F.id),loading:!0},(function(e){e.status===b.c&&le(_,1)})),G({show:!1,id:"",name:""})},handleClose:function(){return G({show:!1,id:"",name:""})}}),Object(i.jsx)("div",{className:"col-md-3 py-5 px-4",children:U.loading?Object(i.jsx)("div",{style:{height:300,display:"flex",alignItems:"center"},children:g.g}):Object(i.jsxs)("div",{className:"pt-3 pr-3",children:[Object(i.jsx)("div",{className:"py-3",children:"Category"}),Object(i.jsxs)("div",{style:{position:"relative"},children:[Object(i.jsx)("input",{ref:oe,className:"form-control",placeholder:"Category name",disabled:!$.editing||$.loading,value:$.value,maxLength:100,onChange:function(e){return ee(Object(c.a)(Object(c.a)({},$),{},{value:e.target.value}))}}),!$.editing&&Object(i.jsx)("i",{className:"fa fa-pencil cursor-pointer",onClick:function(){return ee(Object(c.a)(Object(c.a)({},$),{},{editing:!0}))},style:{position:"absolute",right:10,top:12}})]}),$.editing&&Object(i.jsxs)("div",{className:"pt-3",style:{textAlign:"right",width:"100%"},children:[Object(i.jsx)(r.d,{style:{width:80},color:"secondary",className:"mr-3",onClick:function(){return ee(Object(c.a)(Object(c.a)({},$),{},{editing:!1,value:U.title}))},children:"Cancel"}),Object(i.jsx)(r.d,{style:{width:80},color:"primary",onClick:function(){return de(!0)},disabled:""===$.value.trim()||$.loading||$.value===U.title,children:$.loading?Object(i.jsx)(r.M,{size:"sm",color:"light"}):"Save"})]}),Object(i.jsx)("div",{className:"py-3",children:"Description"}),Object(i.jsxs)("div",{style:{position:"relative"},children:[Object(i.jsx)("textarea",{ref:re,className:"form-control",rows:12,placeholder:"Description",disabled:!ie.editing||ie.loading,value:ie.value,maxLength:1e3,onChange:function(e){return ne(Object(c.a)(Object(c.a)({},ie),{},{value:e.target.value}))}}),!ie.editing&&Object(i.jsx)("i",{className:"fa fa-pencil cursor-pointer",onClick:function(){return ne(Object(c.a)(Object(c.a)({},ie),{},{editing:!0}))},style:{position:"absolute",right:10,top:12}})]}),ie.editing&&Object(i.jsxs)("div",{className:"pt-3",style:{textAlign:"right",width:"100%"},children:[Object(i.jsx)(r.d,{style:{width:80},color:"secondary",className:"mr-3",onClick:function(){return ne(Object(c.a)(Object(c.a)({},ie),{},{editing:!1,value:U.description}))},children:"Cancel"}),Object(i.jsx)(r.d,{style:{width:80},color:"primary",onClick:function(){return de(!1)},disabled:ie.loading||ie.value===U.description,children:ie.loading?Object(i.jsx)(r.M,{size:"sm",color:"light"}):"Save"})]})]})}),Object(i.jsxs)("div",{className:"col-md-9",children:[Object(i.jsx)("div",{className:"d-flex align-items-center justify-content-between mt-2 mb-5",children:Object(i.jsxs)("div",{className:"d-flex",children:[Object(i.jsx)("div",{style:{width:250},children:Object(i.jsx)(j.w,{searchName:_,setSearchName:E,className:"mr-3",searchEmpty:!0,callbackSearch:function(e){return le(e,1)}})}),Object(i.jsx)("div",{style:{width:250},children:Object(i.jsx)(j.x,{className:"mr-3",selected:N,setSelected:k,defaultValue:"Select status",data:u.i,loading:!1,full:!0,value:N?N.name:""})}),Object(i.jsx)("div",{style:{width:250},children:Object(i.jsx)(j.x,Object(c.a)(Object(c.a)({className:"mr-3",selected:I,setSelected:J,defaultValue:"Select uploader",value:D,setValue:P,callbackSearch:se},B),{},{validation:u.d.validate.valueTypingExpressionsName,maxLength:50}))})]})}),Object(i.jsx)("div",{className:"hb-table",children:Object(i.jsx)(r.l,{items:v.data,fields:H,loading:v.loading,noItemsViewSlot:ce,hover:!0,striped:!0,scopedSlots:Object(g.k)(H)})}),Object(g.j)(v.totalPages,v.page,(function(e){v.page!==e&&le(_,e)}),v.total)]})]})]})}}}]);
//# sourceMappingURL=71.ee16f38b.chunk.js.map