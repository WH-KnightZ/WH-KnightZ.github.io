{"version":3,"sources":["views/user/personalInformation/Feedbacks.tsx"],"names":["ratingTypes","Feedbacks","props","dispatch","useDispatch","history","useHistory","auth","useSelector","state","useState","data","loading","full","page","rating","feedbacks","setFeedbacks","currentRating","setCurrentRating","useEffect","payload","callback","method","api","config","rest","getDetailFeedbacks","user_id","status","SUCCESS","totalRatings","number_feedback","user_comments","avatar","first_name","last_name","feedback","customer_comments","modified_date","slice","reduce","a","b","s","c","console","log","callApiAction","className","style","paddingBottom","color","onClick","goBack","loadingSmall","Number","toFixed","size","map","item","ratingType","renderStars","Array","from","length","_","index","display","flexDirection","justifyContent","alignItems","renderRatingSelect","feedbackItem","alt","src","defaultAvatar","moment","format","renderFeedback","textAlign","fontSize"],"mappings":"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","file":"static/js/57.6cb020d8.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { StarRatingStatic, StarRatingFloating, KMSImg } from '../../../components';\nimport moment from 'moment';\nimport './Feedbacks.css';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { callApiAction, SUCCESS } from '../../../store/callApi/actions';\nimport config from '../../../config';\nimport { defaultAvatar, loadingSmall } from '../../../extensions';\nimport { RouteComponentProps, useHistory } from 'react-router-dom';\nimport { HBButtonSmall } from '../../../hbBaseClass';\n\nconst ratingTypes = [0, 5, 4, 3, 2, 1];\n\ntype FeedbackType = {\n  user_id: string;\n  avatar: string;\n  first_name: string;\n  last_name: string;\n  feedback: number;\n  customer_comments: string;\n  modified_date: number;\n};\n\nconst Feedbacks: React.FC<RouteComponentProps> = (props: any) => {\n  const dispatch = useDispatch();\n  const callApi = (payload: any, callback?: (result: any) => void) => dispatch(callApiAction(payload, callback));\n  const history = useHistory();\n  const auth = useSelector((state: any) => state.auth);\n\n  const [feedbacks, setFeedbacks] = useState<{\n    data: {\n      rating: number;\n      number_feedback: number;\n      user_comments: FeedbackType[];\n    }[];\n    loading: boolean;\n    full: boolean;\n    page: number;\n    rating: number;\n  }>({\n    data: [],\n    loading: true,\n    full: true,\n    page: 1,\n    rating: 0,\n  });\n\n  const [currentRating, setCurrentRating] = useState(0);\n\n  useEffect(() => {\n    callApi({ method: 'get', api: config.rest.getDetailFeedbacks(auth.user_id, 1) }, ({ status, data }: any) => {\n      if (status === SUCCESS) {\n        setFeedbacks((feedbacks: any) => {\n          data = [\n            {\n              rating: 0,\n              number_feedback: 3,\n              user_comments: [\n                {\n                  user_id: '0',\n                  avatar: '',\n                  first_name: 'Nguyen',\n                  last_name: 'Khanh',\n                  feedback: 4,\n                  customer_comments: 'sadsad',\n                  modified_date: 1621236992,\n                },\n                {\n                  user_id: '1',\n                  avatar: '',\n                  first_name: 'Nguyen',\n                  last_name: 'Khanh',\n                  feedback: 5,\n                  customer_comments: 'sadsad',\n                  modified_date: 1621236992,\n                },\n                {\n                  user_id: '2',\n                  avatar: '',\n                  first_name: 'Nguyen',\n                  last_name: 'Khanh',\n                  feedback: 5,\n                  customer_comments: 'sadsad',\n                  modified_date: 1621236992,\n                },\n              ],\n            },\n            { rating: 1, number_feedback: 0, user_comments: [] },\n            { rating: 2, number_feedback: 0, user_comments: [] },\n            { rating: 3, number_feedback: 0, user_comments: [] },\n            {\n              rating: 4,\n              number_feedback: 1,\n              user_comments: [\n                {\n                  user_id: '',\n                  avatar: '',\n                  first_name: 'Nguyen',\n                  last_name: 'Khanh',\n                  feedback: 4,\n                  customer_comments: 'sadsad',\n                  modified_date: 1621236992,\n                },\n              ],\n            },\n            {\n              rating: 5,\n              number_feedback: 2,\n              user_comments: [\n                {\n                  user_id: '1',\n                  avatar: '',\n                  first_name: 'Nguyen',\n                  last_name: 'Khanh',\n                  feedback: 5,\n                  customer_comments: 'sadsad',\n                  modified_date: 1621236992,\n                },\n                {\n                  user_id: '2',\n                  avatar: '',\n                  first_name: 'Nguyen',\n                  last_name: 'Khanh',\n                  feedback: 5,\n                  customer_comments: 'sadsad',\n                  modified_date: 1621236992,\n                },\n              ],\n            },\n          ];\n          const totalRatings = data.slice(1).reduce(\n            (a: any, b: any) => {\n              return { s: a.s + b.rating * b.number_feedback, c: a.c + b.number_feedback };\n            },\n            { s: 0, c: 0 },\n          );\n          console.log(totalRatings);\n          const rating = totalRatings.s / (totalRatings.c || 1);\n          return { data, loading: false, full: true, page: 1, rating };\n        });\n      }\n    });\n  }, []);\n\n  const renderRatingSelect = (ratingType: number) => {\n    let renderStars;\n    if (ratingType === 0) renderStars = <span>All</span>;\n    else renderStars = Array.from({ length: ratingType }).map((_, index) => <i key={index} className=\"fa fa-star\" />);\n    return (\n      <div key={ratingType} onClick={() => setCurrentRating(ratingType)} className=\"col-md-2\">\n        <div\n          className={`rating-select ${ratingType === currentRating ? 'active' : ''}`}\n          style={{ display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center' }}\n        >\n          <div>{renderStars}</div>\n          <div>({feedbacks.data[ratingType].number_feedback})</div>\n        </div>\n      </div>\n    );\n  };\n\n  const renderFeedback = (feedbackItem: FeedbackType) => {\n    const { user_id, avatar, first_name, last_name, feedback, customer_comments, modified_date } = feedbackItem;\n    return (\n      <div key={user_id} className=\"feedback-wrapper\">\n        <div className=\"mx-3\">\n          <KMSImg alt=\"user-avatar\" src={avatar || defaultAvatar} className=\"user-avatar\" />\n        </div>\n        <div>\n          <div className=\"feedback-username\">{first_name + ' ' + last_name}</div>\n          <StarRatingStatic size=\"sm\" rating={feedback} />\n          <div className=\"feedback-content\">{customer_comments}</div>\n          <div className=\"feedback-created-date\">{moment(modified_date * 1000).format('DD.MM.YYYY hh:mm')}</div>\n        </div>\n      </div>\n    );\n  };\n\n  return (\n    <div className=\"hb-wrapper\">\n      <div className=\"hb-mx-20\" style={{ paddingBottom: 50 }}>\n        <div className=\"hb-my-28\">\n          <HBButtonSmall color=\"nightblue\" onClick={() => history.goBack()}>\n            <i className=\"hb-icon-arrow-left hb-icon-md\" /> Zurück\n          </HBButtonSmall>\n        </div>\n        <div className=\"hb-title\">Rückmeldungen</div>\n\n        {feedbacks.loading ? (\n          <div className=\"mt-5\">{loadingSmall}</div>\n        ) : (\n          <>\n            <div className=\"pb-5 nurse-wrapper\">\n              <div className=\"text-center\">\n                <span className=\"rating-wrapper\">\n                  <span className=\"rating\">{Number(feedbacks.rating)?.toFixed(1)}</span>\n                  <span className=\"max-rating\">/5.0</span>\n                </span>\n                <StarRatingFloating size=\"lg\" rating={feedbacks.rating} />\n              </div>\n            </div>\n            <div>\n              <div className=\"row px-5 py-3\">{ratingTypes.map((item) => renderRatingSelect(item))}</div>\n              <div>{feedbacks.data[currentRating].user_comments.map((item) => renderFeedback(item))}</div>\n              {feedbacks.data[currentRating].user_comments.length === 0 && (\n                <div className=\"mt-5\" style={{ textAlign: 'center', fontSize: 20 }}>\n                  There is no feedback yet\n                </div>\n              )}\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Feedbacks;\n"],"sourceRoot":""}