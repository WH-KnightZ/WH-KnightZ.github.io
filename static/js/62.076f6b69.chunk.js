(this["webpackJsonphb-frontend"]=this["webpackJsonphb-frontend"]||[]).push([[62],{1047:function(e,t,a){"use strict";a.r(t);var n=a(7),c=a(3),i=a(16),s=a(1),r=a(39),l=a(19),o=a(96),d=a(190),j=a(38),b=a(29),u=a(31),h=a(602),O=a(603),m=a(32),g=a(611),p=function(e){return O.b().shape({name:O.d().trim().required("Category name is required")})},x=function(e){var t=e.searchCategories,a=e.show,n=e.initialValues,r=e.callApi,d=Object(s.useRef)(null),u=Object(s.useState)(!1),O=Object(i.a)(u,2),x=O[0],y=O[1],f=function(){d.current.resetForm(),e.handleClose(),y(!1)};return Object(c.jsxs)(o.c,{centered:!0,show:a,onClose:f,closeOnBackdrop:!1,children:[Object(c.jsxs)(o.d,{children:["Edit Category",Object(c.jsx)(o.b,{onClick:function(){d.current.dirty?y(!0):f()}})]}),Object(c.jsxs)(l.D,{className:"popup--update-user",children:[Object(c.jsxs)(o.c,{size:"sm",show:x,centered:!0,closeOnBackdrop:!1,children:[Object(c.jsx)(l.D,{style:{textAlign:"center",padding:20},children:"Are you sure you want to discard your changes?"}),Object(c.jsxs)(l.E,{style:{display:"flex",justifyContent:"space-around"},children:[Object(c.jsx)("button",{className:"btn btn-danger",style:{width:120},color:"danger",onClick:f,children:"Discard"}),Object(c.jsx)("button",{style:{width:120},className:"btn btn-primary",onClick:function(){return y(!1)},children:"Keep Editing"})]})]}),Object(c.jsx)(l.I,{className:"justify-content-center",children:Object(c.jsx)(l.j,{md:"12",children:Object(c.jsx)(l.h,{children:Object(c.jsx)(l.e,{className:"popup--update-user__card--wrapper",children:Object(c.jsx)(l.f,{children:Object(c.jsx)(h.c,{innerRef:d,enableReinitialize:!0,initialValues:n,validate:Object(m.A)(p),onSubmit:function(e){var a={name:e.name.trim(),type_key:n.type_key};r({method:"put",api:b.d.rest.adminNewsfeedCategory(n.id),body:a,loading:!0},(function(e){e.status===j.c&&(f(),t())}))},children:function(e){var t=e.values,a=e.errors,n=e.touched,i=e.dirty,s=e.handleChange,r=e.handleBlur,o=e.handleSubmit,d=e.isValid;return Object(c.jsxs)(l.q,{onSubmit:o,children:[Object(c.jsx)(g.a,{label:"Category Name (*)",width:140,children:Object(c.jsxs)(l.r,{className:"m-0",children:[Object(c.jsx)(l.u,{type:"text",placeholder:"Category Name (*)",invalid:""!==t.name.trim()&&n.name&&!!a.name,maxLength:50,value:t.name,onBlur:r,onChange:s,name:"name"}),Object(c.jsx)(l.A,{children:a.name})]})}),Object(c.jsx)(l.r,{className:"mb-0",children:Object(c.jsx)(l.I,{children:Object(c.jsxs)(l.j,{xs:"12",style:{textAlign:"right"},children:[Object(c.jsx)(l.d,{color:"secondary",className:"px-4 mr-4",onClick:f,children:"Cancel"}),Object(c.jsx)(l.d,{color:"primary",className:"px-4",type:"submit",disabled:!(d&&i),children:"Save"})]})})})]})}})})})})})})]})]})},y=a(186);t.default=function(e){var t=Object(y.b)().callApi,a=Object(r.h)(),h=Object(s.useState)(!1),O=Object(i.a)(h,2),m=O[0],g=O[1],p=Object(s.useState)(null),f=Object(i.a)(p,2),w=f[0],C=f[1],v=Object(s.useState)(null),k=Object(i.a)(v,2),N=k[0],_=k[1],S=Object(s.useState)(""),A=Object(i.a)(S,2),D=A[0],B=A[1],T=Object(s.useState)({data:[],total:0,page:1,totalPages:0,loading:!0}),V=Object(i.a)(T,2),P=V[0],q=V[1],E=Object(s.useState)({show:!1,id:"",name:""}),R=Object(i.a)(E,2),z=R[0],F=R[1],I=Object(s.useState)({show:!1,id:"",name:""}),L=Object(i.a)(I,2),J=L[0],Y=L[1],G=Object(s.useState)({show:!1,initialValues:{name:""}}),K=Object(i.a)(G,2),M=K[0],W=K[1],H=[{key:"no",_style:{width:"15%",paddingLeft:20}},{key:"name",label:"Category name",_style:{width:"30%"}},{key:"created_date",_style:{width:"15%"},isDate:!0},{key:"top_category",_style:{width:"15%",textAlign:"center"},renderContent:function(e){return Object(c.jsx)("input",{style:{width:20,height:20},checked:"top_topic"===e.type_key,type:"checkbox",onChange:function(){return U(e)}})}},{key:"total_article",label:"Number Of Articles",_style:{width:"15%",textAlign:"center"},renderContent:function(e){var t=e.total_article;return t>0?Object(c.jsx)("div",{className:"link",onClick:function(){return a.push("/admin/newsfeed/".concat(e.id))},children:t}):Object(c.jsx)("div",{children:t})}},{key:"action",_style:{width:"15%",textAlign:"center"},renderContent:function(e){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(l.d,{color:"primary",variant:"outline",shape:"square",size:"sm",style:{marginRight:10},onClick:function(){return W({show:!0,initialValues:e})},children:Object(c.jsx)("i",{className:"fas fa-pencil-alt",children:" "})}),Object(c.jsx)(l.d,{color:"primary",variant:"outline",shape:"square",size:"sm",onClick:function(){return F({show:!0,id:e.id,name:e.name})},children:Object(c.jsx)("i",{className:"fas fa-trash-alt",children:" "})})]})}}],Q=function(e,a){q(Object(n.a)(Object(n.a)({},P),{},{loading:!0})),t({method:"get",api:b.d.rest.adminGetNewsfeedCategories(e,a,m,w?w.getTime()/1e3:null,N?N.getTime()/1e3+86399:null)},(function(t){var a=t.status,c=t.data;a===j.c?q({data:c.categories.map((function(t,a){return Object(n.a)(Object(n.a)({},t),{},{no:a+1+10*(e-1)})})),total:c.total,page:e,totalPages:Math.ceil(c.total/10),loading:!1}):q((function(e){return Object(n.a)(Object(n.a)({},e),{},{loading:!1})}))}))};Object(s.useEffect)((function(){Q(1,D)}),[w,N,m]);var U=function(e){q(Object(n.a)(Object(n.a)({},P),{},{loading:!0})),t({method:"put",api:b.d.rest.adminNewsfeedCategory(e.id),body:{name:e.name,type_key:e.type_key?null:"top_topic"}},(function(e){e.status===j.c?Q(P.page,D):q(Object(n.a)(Object(n.a)({},P),{},{loading:!1}))}))},X=Object(c.jsx)("div",{});P.loading||P.total||(X=Object(c.jsx)("div",{children:"No items found"}));return Object(c.jsxs)("div",{className:"px-5 mx-3",style:{marginTop:10},children:[Object(c.jsx)(x,Object(n.a)(Object(n.a)({callApi:t},M),{},{handleClose:function(){return W(Object(n.a)(Object(n.a)({},M),{},{show:!1}))},searchCategories:function(){return Q(P.page,D)}})),Object(c.jsx)(o.e,{isVisible:z.show,title:"Delete Category",renderContent:Object(u.a)("Are you sure to delete the category",z.name,"If Yes, all articles in this category are also deleted immediately."),leftButtonText:"No",rightButtonText:"Yes",leftButtonOnPress:function(){return F(Object(n.a)(Object(n.a)({},z),{},{show:!1}))},rightButtonOnPress:function(){F(Object(n.a)(Object(n.a)({},z),{},{show:!1})),Y({show:!0,id:z.id,name:z.name})}}),Object(c.jsx)(o.f,{isVisible:J.show,title:"Delete Category",leftButtonText:"Cancel",rightButtonText:"Delete",type:"category",name:J.name,callback:function(e){return function(e,a){F({show:!1,id:"",name:""}),q(Object(n.a)(Object(n.a)({},P),{},{loading:!0})),t({method:"post",api:b.d.rest.confirmPassword(),body:{password:a}},(function(a){a.status===j.c?t({method:"delete",api:b.d.rest.adminNewsfeedCategory(e)},(function(e){e.status===j.c?Q(P.page,D):q((function(e){return Object(n.a)(Object(n.a)({},e),{},{loading:!1})}))})):q((function(e){return Object(n.a)(Object(n.a)({},e),{},{loading:!1})}))}))}(J.id,e)},handleClose:function(){return Y(Object(n.a)(Object(n.a)({},J),{},{show:!1}))}}),Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{children:"All Categories"}),Object(c.jsxs)("div",{className:"d-flex align-items-center mt-4 mb-5",children:[Object(c.jsx)(d.a,{className:"mr-5",searchName:D,setSearchName:B,searchEmpty:!0,callbackSearch:function(e){return Q(1,e)}}),"Filter by top category",Object(c.jsx)("input",{style:{width:20,height:20,marginLeft:20,marginRight:50},type:"checkbox",checked:m,onChange:function(){return g(!m)}}),Object(c.jsx)("div",{children:"From date:"}),Object(c.jsx)("div",{children:Object(c.jsx)(o.g,{maxDate:N||new Date,date:w,setDate:C})}),Object(c.jsx)("div",{children:"To date:"}),Object(c.jsx)("div",{children:Object(c.jsx)(o.g,{minDate:w,date:N,setDate:_})})]})]}),Object(c.jsx)("div",{className:"hb-table",children:Object(c.jsx)(l.l,{items:P.data,fields:H,loading:P.loading,noItemsViewSlot:X,hover:!0,striped:!0,scopedSlots:Object(u.k)(H)})}),Object(u.j)(P.totalPages,P.page,(function(e){P.page!==e&&Q(e,D)}),P.total)]})}},611:function(e,t,a){"use strict";var n=a(3);a(1);t.a=function(e){var t=e.className,a=e.label,c=e.children,i=e.width,s=e.centered,r=e.style;return i=i||110,Object(n.jsxs)("div",{className:"d-flex mb-3 ".concat(s?"align-items-center":""," ").concat(t||""),style:r,children:[Object(n.jsx)("div",{style:{minWidth:i,marginTop:6},children:a}),Object(n.jsx)("div",{style:{width:"calc(100% - ".concat(i,"px)")},children:c})]})}}}]);
//# sourceMappingURL=62.076f6b69.chunk.js.map