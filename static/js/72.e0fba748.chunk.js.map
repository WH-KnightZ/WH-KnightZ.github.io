{"version":3,"sources":["views/admin/mobility/CategoryDetail.tsx"],"names":["CategoryDetail","props","callApi","useApi","categoryId","match","params","id","useState","data","total","totalPages","loading","page","videos","setVideos","status","setStatus","searchText","setSearchText","searchUploaderText","setSearchUploaderText","full","uploaders","setUploaders","selectedUploader","setSelectedUploader","show","name","popupDeleteVideo","setPopupDeleteVideo","fields","key","_style","width","label","isDate","renderContent","item","tag","className","tags","split","showMore","length","title","slice","map","i","color","variant","shape","size","style","marginRight","onClick","useEffect","method","api","SUCCESS","setCategoryInfo","setTitle","editing","value","setDescription","description","categoryInfo","getMobilityUploaders","getVideos","titleRef","current","focus","descriptionRef","window","onbeforeunload","noItems","newPage","config","rest","response","video","index","addNo","Math","ceil","uploaderName","newUsers","users","first_name","last_name","handleSave","isTitle","body","useRef","marginTop","when","message","to","isVisible","adminDeleteContent","leftButtonText","rightButtonText","leftButtonOnPress","rightButtonOnPress","handleClose","height","display","alignItems","loadingSmall","position","ref","placeholder","disabled","maxLength","onChange","e","target","right","top","textAlign","trim","rows","searchName","setSearchName","searchEmpty","callbackSearch","selected","setSelected","defaultValue","listStatus","setValue","validation","validate","valueTypingExpressionsName","items","noItemsViewSlot","hover","striped","scopedSlots","renderFields","pagination"],"mappings":"6OAoaeA,UAjYuC,SAACC,GAAW,IAAD,EACvDC,EAAYC,cAAZD,QAGFE,GADW,UAAGH,EAAMI,aAAT,aAAG,EAAaC,QACPC,GAJqC,EAMnCC,mBAA2B,CACrDC,KAAM,GACNC,MAAO,EACPC,WAAY,EACZC,SAAS,EACTC,KAAM,IAXuD,mBAMxDC,EANwD,KAMhDC,EANgD,OAanCP,mBAAc,MAbqB,mBAaxDQ,EAbwD,KAahDC,EAbgD,OAc3BT,mBAAS,IAdkB,mBAcxDU,EAdwD,KAc5CC,EAd4C,OAgBXX,mBAAS,IAhBE,mBAgBxDY,EAhBwD,KAgBpCC,EAhBoC,OAiB7Bb,mBAAc,CAAEC,KAAM,GAAIG,SAAS,EAAMU,MAAM,EAAOT,KAAM,IAjB/B,mBAiBxDU,EAjBwD,KAiB7CC,EAjB6C,OAkBfhB,mBAAc,MAlBC,mBAkBxDiB,EAlBwD,KAkBtCC,EAlBsC,OAoBflB,mBAAS,CAAEmB,MAAM,EAAOpB,GAAI,GAAIqB,KAAM,KApBvB,mBAoBxDC,EApBwD,KAoBtCC,EApBsC,KAsBzDC,EAAS,CACb,CAAEC,IAAK,KAAMC,OAAQ,CAAEC,MAAO,OAC9B,CAAEF,IAAK,OAAQG,MAAO,QAASF,OAAQ,CAAEC,MAAO,MAChD,CAAEF,IAAK,cAAeC,OAAQ,CAAEC,MAAO,QACvC,CAAEF,IAAK,eAAgBC,OAAQ,CAAEC,MAAO,MAAQE,QAAQ,GACxD,CAAEJ,IAAK,gBAAiBG,MAAO,gBAAiBF,OAAQ,CAAEC,MAAO,MAAQE,QAAQ,GACjF,CAAEJ,IAAK,WAAYC,OAAQ,CAAEC,MAAO,QACpC,CACEF,IAAK,MACLC,OAAQ,CAAEC,MAAO,MACjBG,cAAe,SAACC,GACd,IAAKA,EAAKC,IAAK,OAAO,qBAAKC,UAAU,eAAf,eACtB,IAAMC,EAAOH,EAAKC,IAAIG,MAAM,KACtBC,EAAWF,EAAKG,OAAS,EAE/B,OADID,IAAUF,EAAK,IAAM,QAEvB,qBAAKI,MAAOF,EAAWL,EAAKC,IAAM,GAAIC,UAAU,eAAhD,SACGC,EAAKK,MAAM,EAAG,GAAGC,KAAI,SAACC,GAAD,OACpB,8BAAMA,WAMhB,CAAEhB,IAAK,QAASC,OAAQ,CAAEC,MAAO,OACjC,CAAEF,IAAK,UAAWC,OAAQ,CAAEC,MAAO,OACnC,CAAEF,IAAK,OAAQC,OAAQ,CAAEC,MAAO,OAChC,CAAEF,IAAK,SAAUC,OAAQ,CAAEC,MAAO,OAClC,CACEF,IAAK,SACLC,OAAQ,CAAEC,MAAO,OACjBG,cAAe,SAACC,GAAD,OACb,cAAC,IAAD,CACEW,MAAM,UACNC,QAAQ,UACRC,MAAM,SACNC,KAAK,KACLC,MAAO,CACLC,YAAa,IAEfC,QAAS,kBAAMzB,EAAoB,CAAEH,MAAM,EAAMpB,GAAI+B,EAAK/B,GAAIqB,KAAMU,EAAKV,QAR3E,SAUE,mBAAGY,UAAU,mBAAb,oBAYRgB,qBAAU,WACRtD,EAAQ,CAAEuD,OAAQ,MAAOC,IAAI,4BAAD,OAA8BtD,KAAgB,YAA4B,IAAzBY,EAAwB,EAAxBA,OAAQP,EAAgB,EAAhBA,KAC/EO,IAAW2C,KACbC,EAAgB,aAAEhD,SAAS,GAAUH,IACrCoD,GAAS,2BAAKhB,GAAN,IAAaiB,SAAS,EAAOC,MAAOtD,EAAKoC,SACjDmB,GAAe,2BAAKC,IAAN,IAAmBH,SAAS,EAAOC,MAAOtD,EAAKwD,gBAE7DL,EAAgB,2BAAKM,GAAN,IAAoBtD,SAAS,QAGhDuD,GAAqB,GAAI,KACxB,IAEHX,qBAAU,WACRY,GAAUlD,EAAY,KACrB,CAACF,EAAQS,IA3FmD,MA6FvBjB,mBAAS,CAAEI,SAAS,EAAMiC,MAAO,GAAIoB,YAAa,KA7F3B,mBA6FxDC,EA7FwD,KA6F1CN,EA7F0C,OA8FrCpD,mBAAS,CAAEsD,SAAS,EAAOlD,SAAS,EAAOmD,MAAO,KA9Fb,mBA8FxDlB,EA9FwD,KA8FjDgB,GA9FiD,QA+FzBrD,mBAAS,CAAEsD,SAAS,EAAOlD,SAAS,EAAOmD,MAAO,KA/FzB,qBA+FxDE,GA/FwD,MA+F3CD,GA/F2C,MAiG/DR,qBAAU,WACHX,EAAMiB,SACXO,GAASC,QAAQC,UAChB,CAAC1B,EAAMiB,UAEVN,qBAAU,WACHS,GAAYH,SACjBU,GAAeF,QAAQC,UACtB,CAACN,GAAYH,UAEhBN,qBAAU,WACR,GAAKX,EAAMiB,SAAYG,GAAYH,QAMnC,OAJAW,OAAOC,eAAiB,WACtB,OAAO,GAGF,WACLD,OAAOC,eAAiB,QAEzB,CAAC7B,EAAMiB,QAASG,GAAYH,UAE/B,IAAIa,GAAU,wBAET7D,EAAOF,SACLE,EAAOJ,QAAOiE,GAAU,6CAG/B,IAAMP,GAAY,SAAClD,EAAoB0D,GACrC7D,GAAU,SAACD,GACT,OAAO,2BAAKA,GAAZ,IAAoBF,SAAS,OAE/BV,EACE,CACEuD,OAAQ,MACRC,IAAKmB,IAAOC,KAAKV,UACfhE,EACAqB,EAAmBA,EAAiBlB,GAAK,GACzCS,EAASA,EAAOT,GAAK,GAzIN,GA2IfqE,EACA1D,EACA,MAGJ,SAAC6D,GAAmB,IACV/D,EAAiB+D,EAAjB/D,OAAQP,EAASsE,EAATtE,KACZO,IAAW2C,IACb5C,EAAU,CACRN,KAAMA,EAAKuE,MAAMjC,KAAI,SAACT,EAAW2C,GAAZ,OAA8BC,YAAM5C,EAAM2C,EAAOL,MACtEhE,SAAS,EACTF,MAAOD,EAAKC,MACZC,WAAYwE,KAAKC,KAAK3E,EAAKC,MAvJd,IAwJbG,KAAM+D,IAGR7D,GAAU,SAACD,GACT,OAAO,2BAAKA,GAAZ,IAAoBF,SAAS,WAMjCuD,GAAuB,SAACkB,EAAsBxE,GAClDX,EACE,CACEuD,OAAQ,MACRC,IAAI,qDAAD,OAAuD7C,EAAvD,wBAA2EwE,KAEhF,SAACN,GAAmB,IACV/D,EAAiB+D,EAAjB/D,OAAQP,EAASsE,EAATtE,KACZO,IAAW2C,KACbnC,GAAa,SAACD,GACZ,IAAM+D,EAAW7E,EAAK8E,MAAMxC,KAAI,SAACT,GAC/B,MAAO,CAAE/B,GAAI+B,EAAK/B,GAAIqB,KAAMU,EAAKkD,WAAa,IAAMlD,EAAKmD,cAI3D,MAAO,CAAEhF,KADE,IAATI,EAA+B,KAAjBwE,EAAA,CAAuB,MAAvB,mBAAgCC,IAAYA,EAA1D,sBAA0E/D,EAAUd,MAApF,YAA6F6E,IACzE1E,SAAS,EAAOU,KAAMb,EAAK8E,MAAM3C,OAAS,GAAI/B,KAAMA,UAO9E6E,GAAa,SAACC,GAClBA,EAAU9B,GAAS,2BAAKhB,GAAN,IAAajC,SAAS,KAAUoD,GAAe,2BAAKC,IAAN,IAAmBrD,SAAS,KAC5FV,EACE,CACEuD,OAAQ,MACRC,IAAI,4BAAD,OAA8BtD,GACjCwF,KAAM,CACJ/C,MAAO8C,EAAU9C,EAAMkB,MAAQG,EAAarB,MAC5CoB,YAAa0B,EAAUzB,EAAaD,YAAcA,GAAYF,SAGlE,YAAqB,EAAlB/C,SACc2C,IACTgC,GACF9B,GAAS,2BAAKhB,GAAN,IAAaiB,SAAS,EAAOlD,SAAS,KAC9CgD,GAAgB,SAACM,GACf,OAAO,2BAAKA,GAAZ,IAA0BrB,MAAOA,EAAMkB,aAGzCC,GAAe,2BAAKC,IAAN,IAAmBH,SAAS,EAAOlD,SAAS,KAC1DgD,GAAgB,SAACM,GACf,OAAO,2BAAKA,GAAZ,IAA0BD,YAAaA,GAAYF,YAInD4B,EAAS9B,GAAS,2BAAKhB,GAAN,IAAajC,SAAS,KACtCoD,GAAe,2BAAKC,IAAN,IAAmBrD,SAAS,SAqBjDyD,GAAWwB,iBAAY,MACvBrB,GAAiBqB,iBAAY,MAEnC,OACE,sBAAKrD,UAAU,YAAYa,MAAO,CAAEyC,UAAW,IAA/C,WACIjD,EAAMiB,SAAWG,GAAYH,UAAY,cAAC,IAAD,CAAQiC,MAAM,EAAMC,QAAQ,uCACvE,cAAC,IAAD,CAAMxD,UAAU,cAAcyD,GAAG,6BAAjC,iCAGA,sBAAMzD,UAAU,cAAhB,6BACA,sBAAKA,UAAU,WAAf,UACE,cAAC,IAAD,CACE0D,UAAWrE,EAAiBF,KAC5BkB,MAAM,eACNR,cAAe8D,YAAmB,mCAAoCtE,EAAiBD,MACvFwE,eAAe,KACfC,gBAAgB,MAChBC,kBAAmB,kBAAMxE,EAAoB,CAAEH,MAAM,EAAOpB,GAAI,GAAIqB,KAAM,MAC1E2E,mBA9BkB,WACxBrG,EACE,CAAEuD,OAAQ,SAAUC,IAAI,uBAAD,OAAyB7B,EAAiBtB,IAAMK,SAAS,IAChF,YAAqB,EAAlBI,SACc2C,KACbS,GAAUlD,EAAY,MAI5BY,EAAoB,CAAEH,MAAM,EAAOpB,GAAI,GAAIqB,KAAM,MAsB3C4E,YAAa,kBAAM1E,EAAoB,CAAEH,MAAM,EAAOpB,GAAI,GAAIqB,KAAM,QAEtE,qBAAKY,UAAU,qBAAf,SACI0B,EAAatD,QAyEb,qBAAKyC,MAAO,CAAEoD,OAAQ,IAAKC,QAAS,OAAQC,WAAY,UAAxD,SAAqEC,MAxErE,sBAAKpE,UAAU,YAAf,UACE,qBAAKA,UAAU,OAAf,sBACA,sBAAKa,MAAO,CAAEwD,SAAU,YAAxB,UACE,uBACEC,IAAKzC,GACL7B,UAAU,eACVuE,YAAY,gBACZC,UAAWnE,EAAMiB,SAAWjB,EAAMjC,QAClCmD,MAAOlB,EAAMkB,MACbkD,UAAW,IACXC,SAAU,SAACC,GAAD,OAAYtD,GAAS,2BAAKhB,GAAN,IAAakB,MAAOoD,EAAEC,OAAOrD,aAE3DlB,EAAMiB,SACN,mBACEtB,UAAU,8BACVe,QAAS,kBAAMM,GAAS,2BAAKhB,GAAN,IAAaiB,SAAS,MAC7CT,MAAO,CAAEwD,SAAU,WAAYQ,MAAO,GAAIC,IAAK,SAIpDzE,EAAMiB,SACL,sBAAKtB,UAAU,OAAOa,MAAO,CAAEkE,UAAW,QAASrF,MAAO,QAA1D,UACE,cAAC,IAAD,CAASmB,MAAO,CAAEnB,MAAO,IAAMe,MAAM,YAAYT,UAAU,OAAOe,QA7DxD,kBAAMM,GAAS,2BAAKhB,GAAN,IAAaiB,SAAS,EAAOC,MAAOG,EAAarB,UA6DzE,oBAGA,cAAC,IAAD,CACEQ,MAAO,CAAEnB,MAAO,IAChBe,MAAM,UACNM,QAAS,kBAAMmC,IAAW,IAC1BsB,SAAiC,KAAvBnE,EAAMkB,MAAMyD,QAAiB3E,EAAMjC,SAAWiC,EAAMkB,QAAUG,EAAarB,MAJvF,SAMGA,EAAMjC,QAAU,cAAC,IAAD,CAAUwC,KAAK,KAAKH,MAAM,UAAa,YAI9D,qBAAKT,UAAU,OAAf,yBACA,sBAAKa,MAAO,CAAEwD,SAAU,YAAxB,UACE,0BACEC,IAAKtC,GACLhC,UAAU,eACViF,KAAM,GACNV,YAAY,cACZC,UAAW/C,GAAYH,SAAWG,GAAYrD,QAC9CmD,MAAOE,GAAYF,MACnBkD,UAAW,IACXC,SAAU,SAACC,GAAD,OAAYnD,GAAe,2BAAKC,IAAN,IAAmBF,MAAOoD,EAAEC,OAAOrD,aAEvEE,GAAYH,SACZ,mBACEtB,UAAU,8BACVe,QAAS,kBAAMS,GAAe,2BAAKC,IAAN,IAAmBH,SAAS,MACzDT,MAAO,CAAEwD,SAAU,WAAYQ,MAAO,GAAIC,IAAK,SAIpDrD,GAAYH,SACX,sBAAKtB,UAAU,OAAOa,MAAO,CAAEkE,UAAW,QAASrF,MAAO,QAA1D,UACE,cAAC,IAAD,CAASmB,MAAO,CAAEnB,MAAO,IAAMe,MAAM,YAAYT,UAAU,OAAOe,QA/FlD,kBAC9BS,GAAe,2BAAKC,IAAN,IAAmBH,SAAS,EAAOC,MAAOG,EAAaD,gBA8FvD,oBAGA,cAAC,IAAD,CACEZ,MAAO,CAAEnB,MAAO,IAChBe,MAAM,UACNM,QAAS,kBAAMmC,IAAW,IAC1BsB,SAAU/C,GAAYrD,SAAWqD,GAAYF,QAAUG,EAAaD,YAJtE,SAMGA,GAAYrD,QAAU,cAAC,IAAD,CAAUwC,KAAK,KAAKH,MAAM,UAAa,iBAS1E,sBAAKT,UAAU,WAAf,UACE,qBAAKA,UAAU,8DAAf,SACE,sBAAKA,UAAU,SAAf,UACE,qBAAKa,MAAO,CAAEnB,MAAO,KAArB,SACE,cAAC,IAAD,CACEwF,WAAYxG,EACZyG,cAAexG,EACfqB,UAAU,OACVoF,aAAa,EACbC,eAAgB,SAACH,GAAD,OAAgBtD,GAAUsD,EAAY,QAG1D,qBAAKrE,MAAO,CAAEnB,MAAO,KAArB,SACE,cAAC,IAAD,CACEM,UAAU,OACVsF,SAAU9G,EACV+G,YAAa9G,EACb+G,aAAa,gBACbvH,KAAMwH,IACNrH,SAAS,EACTU,MAAM,EACNyC,MAAO/C,EAASA,EAAOY,KAAO,OAGlC,qBAAKyB,MAAO,CAAEnB,MAAO,KAArB,SACE,cAAC,IAAD,yBACEM,UAAU,OACVsF,SAAUrG,EACVsG,YAAarG,EACbsG,aAAa,kBACbjE,MAAO3C,EACP8G,SAAU7G,EACVwG,eAAgB1D,IACZ5C,GARN,IASE4G,WAAYtD,IAAOuD,SAASC,2BAC5BpB,UAAW,aAKnB,qBAAKzE,UAAU,WAAf,SACE,cAAC,IAAD,CACE8F,MAAOxH,EAAOL,KACdsB,OAAQA,EACRnB,QAASE,EAAOF,QAChB2H,gBAAiB5D,GACjB6D,OAAK,EACLC,SAAO,EACPC,YAAaC,YAAa5G,OAG7B6G,YAAW9H,EAAOH,WAAYG,EAAOD,MApT3B,SAAC+D,GACd9D,EAAOD,OAAS+D,GAClBR,GAAUlD,EAAY0D,KAkTsC9D,EAAOJ","file":"static/js/72.e0fba748.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { Link, Prompt, RouteComponentProps } from 'react-router-dom';\nimport { CDataTable, CButton, CSpinner } from '@coreui/react';\nimport { ConfirmPopup, Search, SelectLoadmore } from '../../../components';\nimport config, { listStatus } from '../../../config';\nimport { SUCCESS } from '../../../store/callApi/actions';\nimport { addNo } from '../../../utils';\nimport { adminDeleteContent, loadingSmall, pagination, renderFields } from '../../../extensions';\nimport { useApi } from 'store/callApi';\n\ntype VideoDataType = {\n  no: number;\n  id: string;\n  name: string;\n  description: string;\n  status: string;\n  created_date: number;\n  modified_date: number;\n  tag: string;\n  uploader: string;\n  views: number;\n  comment: number;\n  like: number;\n};\n\ntype CategoryDataType = {\n  data: VideoDataType[];\n  total: number;\n  totalPages: number;\n  loading: boolean;\n  page: number;\n};\n\nconst pageSize: number = 10;\n\nconst CategoryDetail: React.FC<RouteComponentProps> = (props) => {\n  const { callApi } = useApi();\n\n  const params: any = props.match?.params;\n  const categoryId = params.id;\n\n  const [videos, setVideos] = useState<CategoryDataType>({\n    data: [],\n    total: 0,\n    totalPages: 0,\n    loading: true,\n    page: 1,\n  });\n  const [status, setStatus] = useState<any>(null);\n  const [searchText, setSearchText] = useState('');\n\n  const [searchUploaderText, setSearchUploaderText] = useState('');\n  const [uploaders, setUploaders] = useState<any>({ data: [], loading: true, full: false, page: 1 });\n  const [selectedUploader, setSelectedUploader] = useState<any>(null);\n\n  const [popupDeleteVideo, setPopupDeleteVideo] = useState({ show: false, id: '', name: '' });\n\n  const fields = [\n    { key: 'no', _style: { width: '4%' } },\n    { key: 'name', label: 'Title', _style: { width: 160 } },\n    { key: 'description', _style: { width: '24%' } },\n    { key: 'created_date', _style: { width: '8%' }, isDate: true },\n    { key: 'modified_date', label: 'Last modified', _style: { width: '8%' }, isDate: true },\n    { key: 'uploader', _style: { width: '10%' } },\n    {\n      key: 'tag',\n      _style: { width: '5%' },\n      renderContent: (item: VideoDataType) => {\n        if (!item.tag) return <div className=\"align-middle\">-</div>;\n        const tags = item.tag.split(',');\n        const showMore = tags.length > 2;\n        if (showMore) tags[1] += ' ...';\n        return (\n          <div title={showMore ? item.tag : ''} className=\"align-middle\">\n            {tags.slice(0, 2).map((i) => (\n              <div>{i}</div>\n            ))}\n          </div>\n        );\n      },\n    },\n    { key: 'views', _style: { width: '5%' } },\n    { key: 'comment', _style: { width: '5%' } },\n    { key: 'like', _style: { width: '5%' } },\n    { key: 'status', _style: { width: '8%' } },\n    {\n      key: 'action',\n      _style: { width: '10%' },\n      renderContent: (item: VideoDataType) => (\n        <CButton\n          color=\"primary\"\n          variant=\"outline\"\n          shape=\"square\"\n          size=\"sm\"\n          style={{\n            marginRight: 10,\n          }}\n          onClick={() => setPopupDeleteVideo({ show: true, id: item.id, name: item.name })}\n        >\n          <i className=\"fas fa-trash-alt\"> </i>\n        </CButton>\n      ),\n    },\n  ];\n\n  const pageChange = (newPage: number) => {\n    if (videos.page !== newPage) {\n      getVideos(searchText, newPage);\n    }\n  };\n\n  useEffect(() => {\n    callApi({ method: 'get', api: `/api/v1/admin/categories/${categoryId}` }, ({ status, data }: any) => {\n      if (status === SUCCESS) {\n        setCategoryInfo({ loading: false, ...data });\n        setTitle({ ...title, editing: false, value: data.title });\n        setDescription({ ...description, editing: false, value: data.description });\n      } else {\n        setCategoryInfo({ ...categoryInfo, loading: false });\n      }\n    });\n    getMobilityUploaders('', 1);\n  }, []);\n\n  useEffect(() => {\n    getVideos(searchText, 1);\n  }, [status, selectedUploader]);\n\n  const [categoryInfo, setCategoryInfo] = useState({ loading: true, title: '', description: '' });\n  const [title, setTitle] = useState({ editing: false, loading: false, value: '' });\n  const [description, setDescription] = useState({ editing: false, loading: false, value: '' });\n\n  useEffect(() => {\n    if (!title.editing) return;\n    titleRef.current.focus();\n  }, [title.editing]);\n\n  useEffect(() => {\n    if (!description.editing) return;\n    descriptionRef.current.focus();\n  }, [description.editing]);\n\n  useEffect(() => {\n    if (!title.editing && !description.editing) return;\n\n    window.onbeforeunload = function () {\n      return true;\n    };\n\n    return () => {\n      window.onbeforeunload = null;\n    };\n  }, [title.editing, description.editing]);\n\n  let noItems = <div />;\n\n  if (!videos.loading) {\n    if (!videos.total) noItems = <div>No videos</div>;\n  }\n\n  const getVideos = (searchText: string, newPage: number) => {\n    setVideos((videos: any) => {\n      return { ...videos, loading: true };\n    });\n    callApi(\n      {\n        method: 'get',\n        api: config.rest.getVideos(\n          categoryId,\n          selectedUploader ? selectedUploader.id : '',\n          status ? status.id : '',\n          pageSize,\n          newPage,\n          searchText,\n          '',\n        ),\n      },\n      (response: any) => {\n        const { status, data } = response;\n        if (status === SUCCESS) {\n          setVideos({\n            data: data.video.map((item: any, index: number) => addNo(item, index, newPage)),\n            loading: false,\n            total: data.total,\n            totalPages: Math.ceil(data.total / pageSize),\n            page: newPage,\n          });\n        } else\n          setVideos((videos: any) => {\n            return { ...videos, loading: false };\n          });\n      },\n    );\n  };\n\n  const getMobilityUploaders = (uploaderName: string, page: number) => {\n    callApi(\n      {\n        method: 'get',\n        api: `/api/v1/admin/video/user?page_size=10&page_number=${page}&search_name=${uploaderName}`,\n      },\n      (response: any) => {\n        const { status, data } = response;\n        if (status === SUCCESS) {\n          setUploaders((uploaders: any) => {\n            const newUsers = data.users.map((item: any) => {\n              return { id: item.id, name: item.first_name + ' ' + item.last_name };\n            });\n            const users =\n              page === 1 ? (uploaderName === '' ? [null, ...newUsers] : newUsers) : [...uploaders.data, ...newUsers];\n            return { data: users, loading: false, full: data.users.length < 10, page: page };\n          });\n        }\n      },\n    );\n  };\n\n  const handleSave = (isTitle: boolean) => {\n    isTitle ? setTitle({ ...title, loading: true }) : setDescription({ ...description, loading: true });\n    callApi(\n      {\n        method: 'put',\n        api: `/api/v1/admin/categories/${categoryId}`,\n        body: {\n          title: isTitle ? title.value : categoryInfo.title,\n          description: isTitle ? categoryInfo.description : description.value,\n        },\n      },\n      ({ status }: any) => {\n        if (status === SUCCESS) {\n          if (isTitle) {\n            setTitle({ ...title, editing: false, loading: false });\n            setCategoryInfo((categoryInfo) => {\n              return { ...categoryInfo, title: title.value };\n            });\n          } else {\n            setDescription({ ...description, editing: false, loading: false });\n            setCategoryInfo((categoryInfo) => {\n              return { ...categoryInfo, description: description.value };\n            });\n          }\n        } else {\n          if (isTitle) setTitle({ ...title, loading: false });\n          else setDescription({ ...description, loading: false });\n        }\n      },\n    );\n  };\n  const handleCancelTitle = () => setTitle({ ...title, editing: false, value: categoryInfo.title });\n  const handleCancelDescription = () =>\n    setDescription({ ...description, editing: false, value: categoryInfo.description });\n\n  const handleDeleteVideo = () => {\n    callApi(\n      { method: 'delete', api: `/api/v1/admin/video/${popupDeleteVideo.id}`, loading: true },\n      ({ status }: any) => {\n        if (status === SUCCESS) {\n          getVideos(searchText, 1);\n        }\n      },\n    );\n    setPopupDeleteVideo({ show: false, id: '', name: '' });\n  };\n\n  const titleRef = useRef<any>(null);\n  const descriptionRef = useRef<any>(null);\n\n  return (\n    <div className=\"px-5 mx-3\" style={{ marginTop: 10 }}>\n      {(title.editing || description.editing) && <Prompt when={true} message=\"Changes you made may not be saved.\" />}\n      <Link className=\"py-2 size-1\" to=\"/admin/mobility/categories\">\n        Category Management\n      </Link>\n      <span className=\"size-0 pl-2\">&gt; Edit Category</span>\n      <div className=\"row py-5\">\n        <ConfirmPopup\n          isVisible={popupDeleteVideo.show}\n          title=\"Delete Video\"\n          renderContent={adminDeleteContent('Are you sure to delete the video', popupDeleteVideo.name)}\n          leftButtonText=\"No\"\n          rightButtonText=\"Yes\"\n          leftButtonOnPress={() => setPopupDeleteVideo({ show: false, id: '', name: '' })}\n          rightButtonOnPress={handleDeleteVideo}\n          handleClose={() => setPopupDeleteVideo({ show: false, id: '', name: '' })}\n        />\n        <div className=\"col-md-3 py-5 px-4\">\n          {!categoryInfo.loading ? (\n            <div className=\"pt-3 pr-3\">\n              <div className=\"py-3\">Category</div>\n              <div style={{ position: 'relative' }}>\n                <input\n                  ref={titleRef}\n                  className=\"form-control\"\n                  placeholder=\"Category name\"\n                  disabled={!title.editing || title.loading}\n                  value={title.value}\n                  maxLength={100}\n                  onChange={(e: any) => setTitle({ ...title, value: e.target.value })}\n                />\n                {!title.editing && (\n                  <i\n                    className=\"fa fa-pencil cursor-pointer\"\n                    onClick={() => setTitle({ ...title, editing: true })}\n                    style={{ position: 'absolute', right: 10, top: 12 }}\n                  />\n                )}\n              </div>\n              {title.editing && (\n                <div className=\"pt-3\" style={{ textAlign: 'right', width: '100%' }}>\n                  <CButton style={{ width: 80 }} color=\"secondary\" className=\"mr-3\" onClick={handleCancelTitle}>\n                    Cancel\n                  </CButton>\n                  <CButton\n                    style={{ width: 80 }}\n                    color=\"primary\"\n                    onClick={() => handleSave(true)}\n                    disabled={title.value.trim() === '' || title.loading || title.value === categoryInfo.title}\n                  >\n                    {title.loading ? <CSpinner size=\"sm\" color=\"light\" /> : 'Save'}\n                  </CButton>\n                </div>\n              )}\n              <div className=\"py-3\">Description</div>\n              <div style={{ position: 'relative' }}>\n                <textarea\n                  ref={descriptionRef}\n                  className=\"form-control\"\n                  rows={12}\n                  placeholder=\"Description\"\n                  disabled={!description.editing || description.loading}\n                  value={description.value}\n                  maxLength={1000}\n                  onChange={(e: any) => setDescription({ ...description, value: e.target.value })}\n                />\n                {!description.editing && (\n                  <i\n                    className=\"fa fa-pencil cursor-pointer\"\n                    onClick={() => setDescription({ ...description, editing: true })}\n                    style={{ position: 'absolute', right: 10, top: 12 }}\n                  />\n                )}\n              </div>\n              {description.editing && (\n                <div className=\"pt-3\" style={{ textAlign: 'right', width: '100%' }}>\n                  <CButton style={{ width: 80 }} color=\"secondary\" className=\"mr-3\" onClick={handleCancelDescription}>\n                    Cancel\n                  </CButton>\n                  <CButton\n                    style={{ width: 80 }}\n                    color=\"primary\"\n                    onClick={() => handleSave(false)}\n                    disabled={description.loading || description.value === categoryInfo.description}\n                  >\n                    {description.loading ? <CSpinner size=\"sm\" color=\"light\" /> : 'Save'}\n                  </CButton>\n                </div>\n              )}\n            </div>\n          ) : (\n            <div style={{ height: 300, display: 'flex', alignItems: 'center' }}>{loadingSmall}</div>\n          )}\n        </div>\n        <div className=\"col-md-9\">\n          <div className=\"d-flex align-items-center justify-content-between mt-2 mb-5\">\n            <div className=\"d-flex\">\n              <div style={{ width: 250 }}>\n                <Search\n                  searchName={searchText}\n                  setSearchName={setSearchText}\n                  className=\"mr-3\"\n                  searchEmpty={true}\n                  callbackSearch={(searchName) => getVideos(searchName, 1)}\n                />\n              </div>\n              <div style={{ width: 250 }}>\n                <SelectLoadmore\n                  className=\"mr-3\"\n                  selected={status}\n                  setSelected={setStatus}\n                  defaultValue=\"Select status\"\n                  data={listStatus}\n                  loading={false}\n                  full={true}\n                  value={status ? status.name : ''}\n                />\n              </div>\n              <div style={{ width: 250 }}>\n                <SelectLoadmore\n                  className=\"mr-3\"\n                  selected={selectedUploader}\n                  setSelected={setSelectedUploader}\n                  defaultValue=\"Select uploader\"\n                  value={searchUploaderText}\n                  setValue={setSearchUploaderText}\n                  callbackSearch={getMobilityUploaders}\n                  {...uploaders}\n                  validation={config.validate.valueTypingExpressionsName}\n                  maxLength={50}\n                />\n              </div>\n            </div>\n          </div>\n          <div className=\"hb-table\">\n            <CDataTable\n              items={videos.data}\n              fields={fields}\n              loading={videos.loading}\n              noItemsViewSlot={noItems}\n              hover\n              striped\n              scopedSlots={renderFields(fields)}\n            />\n          </div>\n          {pagination(videos.totalPages, videos.page, pageChange, videos.total)}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default CategoryDetail;\n"],"sourceRoot":""}